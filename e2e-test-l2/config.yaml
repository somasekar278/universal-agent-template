# e2e-test-l2 Configuration (L2 - Assistant)
#
# Context-aware assistant with conversation memory.

type: assistant
name: e2e-test-l2

# Model Configuration
model:
  endpoint: databricks-gpt-5-2
  streaming: false  # Set to true for token-by-token streaming
  temperature: 0.7
  max_tokens: 500
  system_prompt: "You are a helpful AI assistant."

# Memory Configuration (Lakebase - PostgreSQL)
memory:
  # Connection details (or set environment variables)
  host: null  # Set LAKEBASE_HOST env var
  database: null  # Set LAKEBASE_DATABASE env var
  user: null  # Set LAKEBASE_USER env var
  password: null  # Set LAKEBASE_PASSWORD env var
  
  # Memory settings
  max_history: 20  # Maximum number of messages to keep in context

# RAG Configuration (Optional - for knowledge retrieval)
rag:
  enabled: false  # Set to true to enable RAG
  
  # Document source (UC Volume path or local path for testing)
  # UC Volume example: /Volumes/main/default/agent_docs
  # Local path example: /path/to/docs
  source: null
  
  # Backend: pgvector (default, cost-effective) or vector_search (enterprise-scale)
  backend: pgvector
  
  # Retrieval settings
  top_k: 5  # Number of documents to retrieve
  chunk_size: 500  # Characters per chunk
  
  # Embedding model
  embedding_model: databricks-bge-large-en
  
  # pgvector index type (only for pgvector backend)
  # Options: ivfflat (faster indexing, good for updates) or hnsw (better recall, read-heavy)
  index_type: ivfflat  # Default: ivfflat
  
  # Vector Search config (only if backend: vector_search)
  vector_search_endpoint: None  # Your Vector Search endpoint name
  index_name: null  # e.g., main.default.docs_index (catalog.schema.index_name)

# MLflow Configuration
mlflow:
  auto_trace: true
  experiment: /Shared/e2e-test-l2
  show_url: false  # Set to true to see MLflow trace URLs (developer mode)
  
  # Human feedback collection
  assessments:
    enabled: true
    frequency: 5  # Collect feedback every N turns

# Databricks Apps Deployment
deployment:
  name: e2e-test-l2
  port: 8000
  resources:
    cpu: 2
    memory: 4Gi